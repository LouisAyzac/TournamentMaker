{% extends "base_generic.html" %}

{% block content %}
<div class="container mt-5 animate__animated animate__fadeIn">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="section-title"><i class="fas fa-trophy me-2"></i> Liste des Pools</h2>

    <!-- Barre de recherche -->
    <div class="input-group" style="max-width: 300px;">
      <span class="input-group-text bg-white"><i class="fas fa-search"></i></span>
      <input type="text" id="searchInput" onkeyup="searchPool()"
             class="form-control" placeholder="Rechercher une pool...">
    </div>
  </div>

  <!-- Liste des pools -->
  <div class="row" id="poolsList">
    {% for pool in pools %}
    <div class="col-md-6 col-lg-4 mb-4 pool-card-container">
      <div class="card h-100 shadow-sm border-0 hover-shadow">
        <div class="card-body">
          <h4 class="card-title mb-3">
            <a href="{% url 'pool_detail' pool.id %}" class="text-decoration-none text-dark">
              {{ pool.name }}
            </a>
          </h4>

          <p class="text-muted mb-3">
            <i class="fas fa-users me-1"></i> {{ pool.teams.count }} équipe{{ pool.teams.count|pluralize }}
          </p>

          <div class="teams-list">
            {% for team in pool.teams.all %}
              <span class="badge bg-primary text-white me-1 mb-1">
                <a href="{% url 'team_detail' team.id %}" class="text-white text-decoration-none">
                  {{ team.name }}
                </a>
              </span>
            {% empty %}
              <p class="text-muted">Aucune équipe dans cette pool.</p>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="alert alert-info text-center mt-4">
      <i class="fas fa-exclamation-circle me-2"></i> Aucune pool disponible.
    </div>
    {% endfor %}
  </div>
</div>

<script>
  function searchPool() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const pools = document.querySelectorAll('.pool-card-container');

    pools.forEach(pool => {
      const poolName = pool.querySelector('.card-title a').textContent.toLowerCase();
      if (poolName.includes(filter)) {
        pool.style.display = "block";
      } else {
        pool.style.display = "none";
      }
    });
  }
</script>
{% endblock %}
