{% extends 'base_generic.html' %}

{% block title %}
  <title>Créer un tournoi</title>
{% endblock %}

{% block content %}
<div class="container mt-5" style="color: black;">
  <h2 class="text-center mb-4">Créer un nouveau tournoi</h2>

  <form method="POST" class="w-75 mx-auto p-4 border rounded bg-light shadow" style="color: black;" onsubmit="this.querySelector('button[type=submit]').disabled = true; this.querySelector('button[type=submit]').innerHTML = 'Création en cours...';">
    {% csrf_token %}

    <div class="form-group">
      <label for="name"><strong>Nom du tournoi :</strong></label>
      <input type="text" class="form-control" name="name" required>
    </div>

    <div class="form-group">
      <label for="department"><strong>Département :</strong></label>
      <input type="text" class="form-control" name="department" required>
    </div>

    <div class="form-group">
      <label for="address"><strong>Adresse :</strong></label>
      <input type="text" class="form-control" name="address">
    </div>

    <div class="form-group form-check mt-3">
      <input type="checkbox" class="form-check-input" name="is_indoor" id="indoorCheck">
      <label class="form-check-label" for="indoorCheck"><strong>Tournoi en intérieur</strong></label>
    </div>

    <div class="form-group mt-3">
      <label for="start_date"><strong>Date de début :</strong></label>
      <input type="date" class="form-control" name="start_date" required>
    </div>

    <div class="form-group mt-3">
      <label for="end_date"><strong>Date de fin :</strong></label>
      <input type="date" class="form-control" name="end_date" required>
    </div>

    <div class="form-group mt-3">
      <label for="sport"><strong>Sport :</strong></label>
      <select class="form-control" name="sport" required>
        <option value="">-- Choisissez un sport --</option>
        <option value="football">Football</option>
        <option value="volleyball">Volleyball</option>
        <option value="basketball">Basketball</option>
        <option value="rugby">Rugby</option>
      </select>
    </div>

    <hr class="my-4">

    <div class="form-group">
      <label><strong>Type de tournoi :</strong></label>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="tournament_type" id="roundRobin" value="round_robin" checked>
        <label class="form-check-label" for="roundRobin">À la ronde</label>
      </div>

      <div id="nb_pools_div" class="form-group mt-3">
        <label for="nb_pools"><strong>Nombre de poules :</strong></label>
        <input type="number" class="form-control" name="nb_pools" id="nb_pools" min="1" value="1">
      </div>

      <div class="form-check">
        <input class="form-check-input" type="radio" name="tournament_type" id="knockout" value="knockout">
        <label class="form-check-label" for="knockout">Élimination directe</label>
      </div>
    </div>

    <div class="form-group mt-3">
      <label for="nb_teams"><strong>Nombre d’équipes :</strong></label>
      <input type="number" class="form-control" name="nb_teams" min="1" required>
    </div>

    <div class="form-group mt-3">
      <label for="players_per_team"><strong>Joueurs par équipe :</strong></label>
      <input type="number" class="form-control" name="players_per_team" min="1" required>
    </div>

    <div class="form-group mt-3">
      <label for="nb_sets_to_win"><strong>Nombre de sets pour gagner un match :</strong></label>
      <input type="number" class="form-control" name="nb_sets_to_win" min="1" required>
    </div>

    <div class="form-group mt-3">
      <label for="points_per_set"><strong>Points par set :</strong></label>
      <input type="number" class="form-control" name="points_per_set" min="1" required>
    </div>

    <button type="submit" class="btn btn-success mt-4 w-100">Créer le tournoi</button>
  </form>
</div>

<!-- Script pour afficher/masquer "nombre de poules" selon le type de tournoi -->
<script>
  const roundRobinRadio = document.getElementById('roundRobin');
  const knockoutRadio = document.getElementById('knockout');
  const nbPoolsDiv = document.getElementById('nb_pools_div');

  function toggleNbPools() {
    if (roundRobinRadio.checked) {
      nbPoolsDiv.style.display = 'block';
    } else {
      nbPoolsDiv.style.display = 'none';
    }
  }

  roundRobinRadio.addEventListener('change', toggleNbPools);
  knockoutRadio.addEventListener('change', toggleNbPools);
  window.addEventListener('load', toggleNbPools);
</script>
{% endblock %}
