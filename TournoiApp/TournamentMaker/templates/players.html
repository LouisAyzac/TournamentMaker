{% extends "base_generic.html" %}

{% block content %}
<div class="players-container animate__animated animate__fadeIn">
  <div class="players-header">
    <h2 class="section-title"><i class="fas fa-users"></i> Liste des Joueurs</h2>
    
    <!-- Barre de recherche améliorée -->
    <div class="search-container">
      <i class="fas fa-search search-icon"></i>
      <input type="text" id="searchInput" onkeyup="searchPlayer()" 
             placeholder="Rechercher un joueur..." class="search-input">
      <div class="filter-buttons">
        <button class="filter-btn active" onclick="filterPlayers('all')">Tous</button>
        <button class="filter-btn" onclick="filterPlayers('pro')">Pro</button>
        <button class="filter-btn" onclick="filterPlayers('amateur')">Amateur</button>
        <button class="filter-btn" onclick="filterPlayers('junior')">Junior</button>
      </div>
    </div>
  </div>

  <!-- Grille des joueurs -->
  <div class="players-grid" id="playersList">
    {% for player in players %}
    <a href="{% url 'player_detail' player.id %}" class="player-card {{ player.level|lower }}">
      <div class="player-image">
        {% if player.photo %}
          <img src="{{ player.photo.url }}" alt="{{ player.first_name }} {{ player.last_name }}">
        {% else %}
          <div class="default-avatar">
            <i class="fas fa-user"></i>
          </div>
        {% endif %}
        <span class="player-age">{{ player.birth_date }}</span>
      </div>
      
      <div class="player-info">
        <h3 class="player-name">{{ player.first_name }} <strong>{{ player.last_name }}</strong></h3>
        <div class="player-level {{ player.level|lower }}">
          {{ player.get_level_display }}
        </div>
        
      </div>
    </a>
    {% empty %}
    <div class="no-players">
      <i class="fas fa-exclamation-circle"></i>
      <p>Aucun joueur trouvé</p>
    </div>
    {% endfor %}
  </div>
</div>

<script>
  function searchPlayer() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const players = document.querySelectorAll('.player-card');

    players.forEach(player => {
      const playerName = player.querySelector('.player-name').textContent.toLowerCase();
      if (playerName.includes(filter)) {
        player.style.display = "block";
      } else {
        player.style.display = "none";
      }
    });
  }

  function filterPlayers(level) {
    const players = document.querySelectorAll('.player-card');
    const buttons = document.querySelectorAll('.filter-btn');
    
    // Gestion des boutons actifs
    buttons.forEach(btn => {
      btn.classList.toggle('active', btn.textContent.toLowerCase().includes(level) || level === 'all');
    });

    // Filtrage des joueurs
    players.forEach(player => {
      if (level === 'all' || player.classList.contains(level)) {
        player.style.display = "block";
      } else {
        player.style.display = "none";
      }
    });
  }
</script>
{% endblock %}